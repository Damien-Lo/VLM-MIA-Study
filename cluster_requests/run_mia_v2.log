/local/scratch/clo37/anaconda3/envs/vlm_large_mia_llava_venv/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'run_img': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
/home/clo37/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
{'data': {'dataset': 'JaineLi/VL-MIA-image', 'subset': 'img_Flickr', 'split': 'train', 'augmentations': {'RandomResize': {'use': True, 'size': [[256, 256]]}, 'RandomRotation': {'use': True, 'degrees': [45]}, 'RandomAffine': {'use': True, 'degrees': [30], 'translate': [[0.1, 0.1]], 'scale': [[0.75, 1.25]]}, 'GaussianNoise': {'use': True, 'mean': [0.0, 0.0, 0.0, 0.0, 0.0], 'std': [1.0, 2.0, 3.0, 4.0, 5.0]}}}, 'target_model': {'model_path': 'liuhaotian/llava-v1.5-7b', 'model_base': None, 'conv_mode': 'llava_v1', 'gpu_id': 0}, 'reference_model': {'model_path': 'liuhaotian/llava-v1.5-7b', 'model_base': 'llava-v1.5-7b', 'conv_mode': 'llava_v1'}, 'generation': {'use_augmentation': False, 'batch_size': 8, 'num_gen_tokens': 32}, 'inference': {'use_augmentation': True, 'batch_size': 8}, 'img_metrics': {'aug_kld': {'name': 'aug_kl_divs'}, 'max_k_renyi_1_entro': {'name': 'max_k_renyi_1_ratio', 'suffix': 'renyi_1', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'max_k_renyi_2_entro': {'name': 'max_k_renyi_2_ratio', 'alpha': 2, 'suffix': 'renyi_2', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'max_k_renyi_05_entro': {'name': 'max_k_renyi_05_ratio', 'alpha': 0.5, 'suffix': 'renyi_05', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'max_prob_gap': {'name': 'max_prob_gap'}, 'min_k_renyi_1_entro': {'name': 'min_k_renyi_1_ratio', 'suffix': 'renyi_1', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'min_k_renyi_2_entro': {'name': 'min_k_renyi_2_ratio', 'alpha': 2, 'suffix': 'renyi_2', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'min_k_renyi_05_entro': {'name': 'min_k_renyi_05_ratio', 'alpha': 0.5, 'suffix': 'renyi_05', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'mink': {'name': 'mink', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'mod_renyi_1_entro': {'name': 'modified_entropy'}, 'mod_renyi_2_entro': {'name': 'modified_renyi_2', 'alpha': 2}, 'mod_renyi_05_entro': {'name': 'modified_reny_0.5', 'alpha': 0.5}, 'renyi_1': {'name': 'renyi_1'}, 'renyi_2': {'name': 'renyi_2', 'alpha': 2}, 'renyi_05': {'name': 'renyi_0.5', 'alpha': 2}, 'renyi_05_full': {'name': 'renyi_05_full'}, 'cross_entropy_mink': {'name': 'cross_entropy_mink', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'min_k_renyi_05_kl_div': {'name': 'min_k_renyi_05_kl_div', 'alpha': 0.5, 'suffix': 'renyi_05', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max'], 'augmentation_setting_version_accumilator': ['avg', 'max']}, 'min_k_renyi_1_kl_div': {'name': 'min_k_renyi_05_kl_div', 'alpha': 1, 'suffix': 'renyi_1', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max'], 'augmentation_setting_version_accumilator': ['avg', 'max']}, 'min_k_renyi_2_kl_div': {'name': 'min_k_renyi_05_kl_div', 'alpha': 2, 'suffix': 'renyi_2', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max'], 'augmentation_setting_version_accumilator': ['avg', 'max']}, 'min_k_renyi_inf_kl_div': {'name': 'min_k_renyi_inf_kl_div', 'suffix': 'renyi_inf', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max'], 'augmentation_setting_version_accumilator': ['avg', 'max']}, 'min_k_renyi_divergence_025': {'name': 'min_k_renyi_divergence_025', 'alpha': 0.25, 'suffix': 'renyi_025', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max'], 'augmentation_setting_version_accumilator': ['avg', 'max']}, 'min_k_renyi_divergence_05': {'name': 'min_k_renyi_divergence_05', 'alpha': 0.5, 'suffix': 'renyi_05', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max'], 'augmentation_setting_version_accumilator': ['avg', 'max']}, 'min_k_renyi_divergence_2': {'name': 'min_k_renyi_divergence_2', 'alpha': 2, 'suffix': 'renyi_2', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max'], 'augmentation_setting_version_accumilator': ['avg', 'max']}, 'min_k_renyi_divergence_4': {'name': 'min_k_renyi_divergence_4', 'alpha': 4, 'suffix': 'renyi_4', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max'], 'augmentation_setting_version_accumilator': ['avg', 'max']}, 'metrics_to_use': ['mink', 'max_k_renyi_1_entro', 'max_k_renyi_2_entro', 'max_k_renyi_05_entro', 'max_prob_gap', 'min_k_renyi_1_entro', 'min_k_renyi_2_entro', 'min_k_renyi_05_entro', 'mod_renyi_1_entro', 'mod_renyi_2_entro', 'mod_renyi_05_entro', 'min_k_renyi_05_kl_div', 'min_k_renyi_1_kl_div', 'min_k_renyi_2_kl_div', 'min_k_renyi_inf_kl_div', 'min_k_renyi_divergence_25', 'min_k_renyi_divergence_05', 'min_k_renyi_divergence_2', 'min_k_renyi_divergence_4'], 'parts': ['img'], 'get_meta_values': True, 'get_token_labels': True}, 'prompt': {'text': 'Describe this image concisely.'}, 'path': {'cache_dir': '/local/scratch/clo37/cache', 'output_dir': '/home/clo37/priv/VLM-MIA-Study/LatestResults/2025_08_12_11-30'}, 'wandb': {'project': 'vlm_mia', 'name': 'run_001', 'mode': 'enabled'}, 'test_run': {'test_run': False}}
Augmentations Used:
{'RandomResize': {'use': True, 'size': [[256, 256]]}, 'RandomRotation': {'use': True, 'degrees': [45]}, 'RandomAffine': {'use': True, 'degrees': [30], 'translate': [[0.1, 0.1]], 'scale': [[0.75, 1.25]]}, 'GaussianNoise': {'use': True, 'mean': [0.0, 0.0, 0.0, 0.0, 0.0], 'std': [1.0, 2.0, 3.0, 4.0, 5.0]}}
Requested meta values JSON File
Requested token labels JSON File
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/local/scratch/clo37/anaconda3/envs/vlm_large_mia_llava_venv/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  9.00it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 11.25it/s]
Map:   0%|          | 0/600 [00:00<?, ? examples/s]Map: 100%|██████████| 600/600 [02:45<00:00,  3.62 examples/s]Map: 100%|██████████| 600/600 [02:54<00:00,  3.44 examples/s]
Running inference:   0%|          | 0/75 [00:00<?, ?batch/s]Running inference:   1%|▏         | 1/75 [03:15<4:00:55, 195.35s/batch]Running inference:   3%|▎         | 2/75 [05:47<3:26:39, 169.86s/batch]Running inference:   4%|▍         | 3/75 [08:40<3:25:48, 171.51s/batch]Running inference:   5%|▌         | 4/75 [11:07<3:11:18, 161.67s/batch]Running inference:   7%|▋         | 5/75 [14:01<3:13:45, 166.08s/batch]Running inference:   8%|▊         | 6/75 [16:26<3:03:00, 159.14s/batch]Running inference:   9%|▉         | 7/75 [19:21<3:06:03, 164.17s/batch]Running inference:  11%|█         | 8/75 [21:49<2:57:28, 158.93s/batch]Running inference:  12%|█▏        | 9/75 [24:40<2:59:07, 162.84s/batch]Running inference:  13%|█▎        | 10/75 [27:04<2:50:07, 157.04s/batch]Running inference:  15%|█▍        | 11/75 [29:56<2:52:25, 161.64s/batch]Running inference:  16%|█▌        | 12/75 [32:21<2:44:10, 156.35s/batch]Running inference:  17%|█▋        | 13/75 [35:11<2:45:54, 160.56s/batch]Running inference:  19%|█▊        | 14/75 [37:34<2:37:58, 155.39s/batch]Running inference:  20%|██        | 15/75 [40:27<2:40:41, 160.69s/batch]Running inference:  21%|██▏       | 16/75 [42:51<2:32:57, 155.56s/batch]Running inference:  23%|██▎       | 17/75 [45:24<2:29:40, 154.83s/batch]Running inference:  24%|██▍       | 18/75 [47:49<2:24:18, 151.90s/batch]Running inference:  25%|██▌       | 19/75 [50:41<2:27:22, 157.91s/batch]Running inference:  27%|██▋       | 20/75 [53:07<2:21:21, 154.21s/batch]Running inference:  28%|██▊       | 21/75 [55:58<2:23:30, 159.45s/batch]Running inference:  29%|██▉       | 22/75 [58:24<2:17:15, 155.39s/batch]Running inference:  31%|███       | 23/75 [1:01:15<2:18:47, 160.15s/batch]Running inference:  32%|███▏      | 24/75 [1:03:39<2:11:51, 155.14s/batch]Running inference:  33%|███▎      | 25/75 [1:06:33<2:13:59, 160.78s/batch]Running inference:  35%|███▍      | 26/75 [1:08:58<2:07:28, 156.09s/batch]Running inference:  36%|███▌      | 27/75 [1:11:49<2:08:32, 160.67s/batch]Running inference:  37%|███▋      | 28/75 [1:14:14<2:02:02, 155.81s/batch]Running inference:  39%|███▊      | 29/75 [1:17:07<2:03:22, 160.92s/batch]Running inference:  40%|████      | 30/75 [1:19:32<1:57:09, 156.21s/batch]Running inference:  41%|████▏     | 31/75 [1:22:23<1:57:51, 160.71s/batch]Running inference:  43%|████▎     | 32/75 [1:24:47<1:51:30, 155.59s/batch]Running inference:  44%|████▍     | 33/75 [1:27:38<1:52:08, 160.19s/batch]Running inference:  45%|████▌     | 34/75 [1:30:02<1:46:12, 155.41s/batch]Running inference:  47%|████▋     | 35/75 [1:32:54<1:47:00, 160.51s/batch]Running inference:  48%|████▊     | 36/75 [1:35:19<1:41:16, 155.80s/batch]Running inference:  49%|████▉     | 37/75 [1:38:10<1:41:32, 160.34s/batch]Running inference:  51%|█████     | 38/75 [1:40:36<1:36:15, 156.10s/batch]Running inference:  52%|█████▏    | 39/75 [1:43:26<1:36:08, 160.24s/batch]Running inference:  53%|█████▎    | 40/75 [1:45:51<1:30:42, 155.50s/batch]Running inference:  55%|█████▍    | 41/75 [1:48:42<1:30:48, 160.24s/batch]Running inference:  56%|█████▌    | 42/75 [1:51:07<1:25:43, 155.86s/batch]Running inference:  57%|█████▋    | 43/75 [1:53:58<1:25:25, 160.17s/batch]Running inference:  59%|█████▊    | 44/75 [1:56:24<1:20:37, 156.04s/batch]Running inference:  60%|██████    | 45/75 [1:59:16<1:20:20, 160.70s/batch]Running inference:  61%|██████▏   | 46/75 [2:01:41<1:15:28, 156.16s/batch]Running inference:  63%|██████▎   | 47/75 [2:04:14<1:12:20, 155.02s/batch]Running inference:  64%|██████▍   | 48/75 [2:06:38<1:08:20, 151.89s/batch]Running inference:  65%|██████▌   | 49/75 [2:09:13<1:06:11, 152.75s/batch]Running inference:  67%|██████▋   | 50/75 [2:11:39<1:02:48, 150.73s/batch]Running inference:  68%|██████▊   | 51/75 [2:14:05<59:43, 149.30s/batch]  Running inference:  69%|██████▉   | 52/75 [2:16:29<56:35, 147.63s/batch]Running inference:  71%|███████   | 53/75 [2:19:22<56:55, 155.24s/batch]Running inference:  72%|███████▏  | 54/75 [2:21:47<53:19, 152.37s/batch]Running inference:  73%|███████▎  | 55/75 [2:24:43<53:07, 159.40s/batch]Running inference:  75%|███████▍  | 56/75 [2:27:12<49:27, 156.17s/batch]Running inference:  76%|███████▌  | 57/75 [2:30:07<48:35, 162.00s/batch]Running inference:  77%|███████▋  | 58/75 [2:32:35<44:41, 157.76s/batch]Running inference:  79%|███████▊  | 59/75 [2:35:29<43:20, 162.55s/batch]Running inference:  80%|████████  | 60/75 [2:37:57<39:30, 158.05s/batch]Running inference:  81%|████████▏ | 61/75 [2:40:51<38:02, 163.04s/batch]Running inference:  83%|████████▎ | 62/75 [2:43:18<34:16, 158.19s/batch]Running inference:  84%|████████▍ | 63/75 [2:46:11<32:32, 162.72s/batch]Running inference:  85%|████████▌ | 64/75 [2:48:41<29:07, 158.86s/batch]Running inference:  87%|████████▋ | 65/75 [2:51:14<26:09, 156.98s/batch]Running inference:  88%|████████▊ | 66/75 [2:53:38<22:58, 153.22s/batch]Running inference:  89%|████████▉ | 67/75 [2:56:11<20:25, 153.21s/batch]Running inference:  91%|█████████ | 68/75 [2:58:36<17:34, 150.59s/batch]Running inference:  92%|█████████▏| 69/75 [3:01:10<15:10, 151.77s/batch]Running inference:  93%|█████████▎| 70/75 [3:03:37<12:31, 150.26s/batch]Running inference:  95%|█████████▍| 71/75 [3:06:09<10:03, 150.75s/batch]Running inference:  96%|█████████▌| 72/75 [3:08:35<07:27, 149.24s/batch]Running inference:  97%|█████████▋| 73/75 [3:11:09<05:01, 150.69s/batch]Running inference:  99%|█████████▊| 74/75 [3:13:34<02:29, 149.05s/batch]Running inference: 100%|██████████| 75/75 [3:16:08<00:00, 150.63s/batch]Running inference: 100%|██████████| 75/75 [3:16:08<00:00, 156.92s/batch]
Saved processed_meta_values to /home/clo37/priv/VLM-MIA-Study/LatestResults/2025_08_12_11-30/processed_meta_values.json
Saved token_labels to /home/clo37/priv/VLM-MIA-Study/LatestResults/2025_08_12_11-30/token_labels.json
Saved preds to /home/clo37/priv/VLM-MIA-Study/LatestResults/2025_08_12_11-30/preds.json
Saved auc to /home/clo37/priv/VLM-MIA-Study/LatestResults/2025_08_12_11-30/auc.json
Saved acc to /home/clo37/priv/VLM-MIA-Study/LatestResults/2025_08_12_11-30/acc.json
Saved auc_low to /home/clo37/priv/VLM-MIA-Study/LatestResults/2025_08_12_11-30/auc_low.json
